<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings — FocusFlow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        .modal-overlay {
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-card {
            transform: scale(0.95) translateY(20px);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-overlay.active .modal-card {
            transform: scale(1) translateY(0);
        }

        .toggle-bg {
            transition: background-color 0.2s ease;
        }

        .toggle-dot {
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Initial state for staggered entrance */
        .setting-section {
            opacity: 0;
            transform: translateY(20px);
        }

        /* Hide scrollbar for cleaner mobile look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-white text-neutral-900 antialiased pb-24 lg:pb-0">

    <!-- Desktop Navigation -->
    <nav class="sticky top-0 z-50 w-full border-b border-neutral-100 bg-white/80 backdrop-blur-md hidden lg:block">
        <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
            <a href="/" class="flex items-center gap-2">
                <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center text-white">
                    <i data-lucide="zap" class="w-4 h-4 fill-white"></i>
                </div>
                <span class="font-bold text-neutral-900 tracking-tight text-xl">FocusFlow</span>
            </a>

            <div id="desktop-menu" class="flex items-center gap-1">
                <!-- Links injected by JS -->
            </div>

            <div class="flex items-center gap-4">
                <div class="flex items-center gap-1.5 px-3 py-1.5 bg-amber-50 rounded-full border border-amber-100">
                    <i data-lucide="zap" class="w-3.5 h-3.5 text-amber-500 fill-amber-500"></i>
                    <span id="desktop-xp" class="text-xs font-black text-amber-700">0</span>
                </div>
                <div class="w-8 h-8 rounded-full bg-neutral-100 border border-neutral-200 flex items-center justify-center cursor-pointer hover:bg-neutral-200 transition-colors">
                    <i data-lucide="bell" class="w-4 h-4 text-neutral-400"></i>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-2xl mx-auto px-4 py-8 md:py-12">
        
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-extrabold tracking-tight">Settings</h1>
            <p class="text-neutral-500 mt-1">Manage your account and preferences.</p>
        </div>

        <!-- Pro Banner (Animated Entrance) -->
        <div id="pro-banner" class="setting-section relative overflow-hidden bg-neutral-900 rounded-2xl p-6 mb-10 text-white shadow-xl">
            <div class="absolute top-0 right-0 -translate-y-1/2 translate-x-1/2 w-64 h-64 bg-indigo-500/10 rounded-full blur-3xl"></div>
            
            <div class="relative flex items-center gap-4 mb-6">
                <div class="p-3 bg-white/10 backdrop-blur rounded-xl">
                    <i data-lucide="crown" class="w-6 h-6 text-indigo-400"></i>
                </div>
                <div>
                    <h3 class="text-lg font-bold">Productivity Pro</h3>
                    <p class="text-sm text-neutral-400">Unlock your full potential</p>
                </div>
            </div>

            <div id="pro-features-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6 text-sm text-neutral-300">
                <!-- Features injected by JS -->
            </div>

            <button onclick="toggleModal(true)" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-bold transition-all shadow-lg shadow-indigo-500/20 active:scale-[0.98]">
                Upgrade Now — $4.99/mo
            </button>
        </div>

        <!-- Dynamic Settings Sections -->
        <div id="settings-container" class="space-y-8"></div>

        <!-- User Profile (Mock) -->
        <div id="user-profile" class="setting-section mt-8 p-4 bg-neutral-50 rounded-2xl border border-neutral-100">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-neutral-900 rounded-full flex items-center justify-center text-white font-bold text-lg">
                    J
                </div>
                <div>
                    <p class="font-bold text-neutral-900">Jane Doe</p>
                    <p class="text-sm text-neutral-500">jane.doe@example.com</p>
                </div>
            </div>
        </div>

        <!-- Sign Out -->
        <div class="mt-12 pt-8 border-t border-neutral-200">
            <button onclick="handleLogout()" class="w-full flex items-center justify-center gap-2 border border-red-200 text-red-600 hover:bg-red-50 py-3 rounded-xl font-medium transition-all active:scale-[0.98]">
                <i data-lucide="log-out" class="w-4 h-4"></i>
                Sign Out
            </button>
            <p class="text-center text-[10px] text-neutral-400 mt-4 uppercase tracking-widest">Version 2.4.0 — FocusFlow</p>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div class="fixed bottom-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-lg border-t border-neutral-100 p-2 lg:hidden">
        <div id="mobile-menu" class="flex items-center justify-around max-w-md mx-auto">
            <!-- Links injected by JS -->
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgrade-modal" class="modal-overlay fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm">
        <div class="absolute inset-0" onclick="toggleModal(false)"></div>
        <div class="modal-card relative bg-white w-full max-w-md rounded-2xl shadow-2xl p-6">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-xl font-bold">Choose a Plan</h3>
                    <p class="text-sm text-neutral-500">Supercharge your productivity.</p>
                </div>
                <button onclick="toggleModal(false)" class="p-1 hover:bg-neutral-100 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-neutral-400"></i>
                </button>
            </div>
            
            <div class="space-y-4 py-2">
                <div class="p-4 border-2 border-indigo-600 rounded-xl bg-indigo-50/50 flex justify-between items-center cursor-pointer">
                    <div>
                        <p class="text-sm font-bold text-indigo-900">Annual Pro</p>
                        <p class="text-xs text-indigo-700">$39.99 / year</p>
                    </div>
                    <div class="bg-indigo-600 text-white text-[10px] px-2 py-1 rounded-full font-bold uppercase">Save 33%</div>
                </div>

                <div class="p-4 border border-neutral-200 rounded-xl flex justify-between items-center hover:border-indigo-300 transition-colors cursor-pointer">
                    <div>
                        <p class="text-sm font-bold text-neutral-900">Monthly Pro</p>
                        <p class="text-xs text-neutral-500">$4.99 / month</p>
                    </div>
                </div>

                <button onclick="toggleModal(false)" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-4 rounded-xl font-bold transition-all active:scale-[0.98] shadow-lg shadow-indigo-200">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <script>
        const currentPageName = 'Settings';

        // Updated MENU_ITEMS to include href paths
        const MENU_ITEMS = [
            { id: 'Home', icon: 'calendar', label: 'home', href: 'index.html' },
            { id: 'Tasks', icon: 'check-circle-2', label: 'tasks', href: 'tasks.html' },
            { id: 'Analytics', icon: 'bar-chart-2', label: 'analytics', href: 'analytics.html' },
            { id: 'Rewards', icon: 'gift', label: 'rewards', href: 'rewards.html' },
            { id: 'Progress', icon: 'trending-up', label: 'progress', href: 'progress.html' },
            { id: 'Settings', icon: 'settings', label: 'settings', href: 'settings.html' }
        ];

        const PRO_FEATURES = [
            'Unlimited tasks & projects',
            'Advanced data analytics',
            'Dynamic reward multipliers',
            'Streak protection (1 freeze/mo)',
            'Full Dark Mode experience',
            'Priority email support'
        ];

        const SETTINGS_SECTIONS = [
            {
                title: 'Account',
                items: [
                    { icon: 'user', label: 'Profile', desc: 'Your account information' },
                    { icon: 'globe', label: 'Language', desc: 'English (US)' }
                ]
            },
            {
                title: 'Preferences',
                items: [
                    { icon: 'bell', label: 'Notifications', desc: 'Task reminders and activity alerts', toggle: true, defaultChecked: true },
                    { icon: 'palette', label: 'Appearance', desc: 'Dark mode is a Pro feature', toggle: true, defaultChecked: false, disabled: true }
                ]
            },
            {
                title: 'Data & Security',
                items: [
                    { icon: 'download', label: 'Export Data', desc: 'Download a JSON backup', action: 'export' },
                    { icon: 'shield', label: 'Privacy', desc: 'Manage visibility settings' }
                ]
            }
        ];

        // State Management
        const state = {
            toggles: {
                'Notifications': true,
                'Appearance': false
            },
            xp: 1250 // Example XP
        };

        function init() {
            renderNavigation();
            renderFeatures();
            renderSections();
            updateXP();
            lucide.createIcons();
            animateEntrance();
        }

        function renderNavigation() {
            const desktopMenu = document.getElementById('desktop-menu');
            const mobileMenu = document.getElementById('mobile-menu');

            desktopMenu.innerHTML = MENU_ITEMS.map(item => {
                const isActive = currentPageName === item.id;
                return `
                    <a href="${item.href}" class="px-4 py-2 rounded-full text-sm font-bold capitalize transition-all ${
                        isActive ? 'bg-neutral-900 text-white' : 'text-neutral-500 hover:bg-neutral-100'
                    }">
                        ${item.label}
                    </a>
                `;
            }).join('');

            mobileMenu.innerHTML = MENU_ITEMS.map(item => {
                const isActive = currentPageName === item.id;
                return `
                    <a href="${item.href}" class="flex flex-col items-center gap-1 p-2 rounded-2xl transition-all ${
                        isActive ? 'text-neutral-900' : 'text-neutral-400'
                    }">
                        <i data-lucide="${item.icon}" class="w-6 h-6 transition-transform ${isActive ? 'scale-110' : ''}"></i>
                        <span class="text-[10px] font-bold uppercase tracking-tighter">${item.label}</span>
                    </a>
                `;
            }).join('');
        }

        function updateXP() {
            document.getElementById('desktop-xp').textContent = state.xp;
        }

        function renderFeatures() {
            const grid = document.getElementById('pro-features-grid');
            grid.innerHTML = PRO_FEATURES.map(feature => `
                <div class="flex items-center gap-2">
                    <i data-lucide="check-circle-2" class="w-4 h-4 text-indigo-400"></i>
                    <span>${feature}</span>
                </div>
            `).join('');
        }

        function renderSections() {
            const container = document.getElementById('settings-container');
            container.innerHTML = SETTINGS_SECTIONS.map((section, si) => `
                <div class="setting-section">
                    <h3 class="text-[10px] font-bold text-neutral-400 uppercase tracking-widest mb-3">
                        ${section.title}
                    </h3>
                    <div class="bg-white border border-neutral-100 rounded-2xl overflow-hidden shadow-sm">
                        ${section.items.map((item, ii) => {
                            const isLast = ii === section.items.length - 1;
                            const isToggled = state.toggles[item.label];
                            
                            return `
                                <div 
                                    class="flex items-center justify-between p-4 ${!isLast ? 'border-b border-neutral-100' : ''} ${item.disabled ? 'opacity-60 cursor-not-allowed' : 'hover:bg-neutral-50 cursor-pointer'} transition-colors"
                                    onclick="handleItemClick('${item.action}', '${item.label}', ${!!item.toggle})"
                                >
                                    <div class="flex items-center gap-4">
                                        <div class="p-2 bg-neutral-100 rounded-xl">
                                            <i data-lucide="${item.icon}" class="w-5 h-5 text-neutral-600"></i>
                                        </div>
                                        <div>
                                            <p class="font-medium text-neutral-900">${item.label}</p>
                                            <p class="text-sm text-neutral-500">${item.desc}</p>
                                        </div>
                                    </div>
                                    
                                    ${item.toggle ? `
                                        <div class="relative w-12 h-7 rounded-full toggle-bg ${isToggled ? 'bg-neutral-900' : 'bg-neutral-200'}">
                                            <div class="absolute top-1 w-5 h-5 bg-white rounded-full shadow toggle-dot ${isToggled ? 'translate-x-6' : 'translate-x-1'}"></div>
                                        </div>
                                    ` : `
                                        <i data-lucide="chevron-right" class="w-5 h-5 text-neutral-400"></i>
                                    `}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');
        }

        function handleItemClick(action, label, isToggle) {
            if (isToggle) {
                const section = SETTINGS_SECTIONS.find(s => s.items.find(i => i.label === label));
                const item = section.items.find(i => i.label === label);
                if (item.disabled) return;

                state.toggles[label] = !state.toggles[label];
                renderSections();
                lucide.createIcons();
                return;
            }

            if (action === 'export') {
                handleExport();
            }
        }

        function toggleModal(show) {
            const modal = document.getElementById('upgrade-modal');
            if (show) {
                modal.classList.add('active');
            } else {
                modal.classList.remove('active');
            }
        }

        function animateEntrance() {
            const sections = document.querySelectorAll('.setting-section');
            sections.forEach((section, index) => {
                setTimeout(() => {
                    section.animate([
                        { opacity: 0, transform: 'translateY(20px)' },
                        { opacity: 1, transform: 'translateY(0)' }
                    ], {
                        duration: 600,
                        easing: 'cubic-bezier(0.22, 1, 0.36, 1)',
                        fill: 'forwards'
                    });
                }, index * 100);
            });
        }

        function handleExport() {
            const mockData = {
                user: { name: "Jane Doe", email: "jane.doe@example.com" },
                settings: state.toggles,
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(mockData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `focusflow-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function handleLogout() {
            console.log("Logging out...");
            document.body.style.opacity = '0.5';
            setTimeout(() => location.reload(), 500);
        }

        window.onload = init;
    </script>
</body>
</html>
